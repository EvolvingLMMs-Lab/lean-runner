syntax = "proto3";

package lean_runner;

option go_package = "github.com/EvolvingLMMs-Lab/lean-runner/server/gen/go/lean_runner";

import "google/protobuf/struct.proto";

// Service for interacting with the database.
service DbService {
  // Fetch data from the database using a SQL query.
  // Returns a stream of rows.
  rpc Fetch(FetchRequest) returns (stream FetchResponse);

  // Clean the database by removing old records.
  rpc Clean(CleanRequest) returns (CleanResponse);
}

message FetchRequest {
  string query = 1;
  int32 batch_size = 2;
}

// A single row from the database query result, represented as a JSON-like object.
message FetchResponse {
  google.protobuf.Struct row = 1;
}

message CleanRequest {
  // The minimum age in seconds for records to be deleted.
  int32 seconds = 1;
}

message CleanResponse {
  string message = 1;
}
